# Default deny policy
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: default-deny
spec:
  podSelector: {}
---
# Accept policy for ControllerService pods
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-controller-to-all
spec:
  podSelector:
    matchLabels:
      app: controllerservice
  ingress:
    - from: []
---
# Accept policy for GroundService pods
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-ground-to-all
spec:
  podSelector:
    matchLabels:
      app: groundservice
  ingress:
    - from: []
---
# Accept policies for DroneService pods
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone1-to-drone2
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone1service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone2service2
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone1-to-drone2
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone1service1
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone2service1
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone2-to-drone1
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone2service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone1service2
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone2-to-drone1
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone2service1
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone1service1
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone1-to-drone3
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone1service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service1
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone2-to-drone3
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone2service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service2
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone3-to-drone1
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service1
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone1service1
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone3-to-drone2
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone2service1
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone4-to-drone3
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone4service1
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service2
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone3-to-drone4
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service1
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone4service2
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone4-to-drone3
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone4service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service1
---
kind: NetworkPolicy
apiVersion: networking.k8s.io/v1
metadata:
  name: allow-drone3-to-drone4
spec:
  podSelector:
    matchLabels:
      app: droneservice
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone3service2
        - podSelector:
            matchLabels:
              app: droneservice
              name: drone4service1
